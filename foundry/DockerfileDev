FROM ghcr.io/foundry-rs/foundry

RUN apk add --no-cache zsh
RUN git clone https://github.com/ohmyzsh/ohmyzsh.git /root/.oh-my-zsh
RUN git clone https://github.com/zsh-users/zsh-autosuggestions.git /root/.oh-my-zsh/custom/plugins/zsh-autosuggestions
COPY .zshrc /tmp/.zshrc
COPY codespaces.zsh-theme /tmp/codespaces.zsh-theme
RUN cat /tmp/.zshrc > /root/.zshrc
RUN cat /tmp/codespaces.zsh-theme > /root/.oh-my-zsh/custom/themes/codespaces.zsh-theme

RUN adduser -D -u 1001 -h /home/vscode -s /bin/bash vscode
RUN addgroup -g 10001 -S foundrygrp
RUN addgroup vscode foundrygrp
RUN sed -i 's|vscode:.*$|vscode:*:12345:0:99999:7:::|' /etc/passwd
RUN install -d -m 700 -o vscode -g foundrygrp /home/vscode

CMD ["sleep","infinity"]
